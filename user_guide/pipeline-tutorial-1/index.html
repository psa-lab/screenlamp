<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="A toolkit for ligand-based screening">
        <meta name="author" content="Sebastian Raschka">
        <link rel="canonical" href="http://rasbt.github.io/screenlamp/user_guide/pipeline-tutorial-1/index.html">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Pipeline Tutorial - screenlamp</title>
        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/base.css" rel="stylesheet">
        <link href="../../extra.css" rel="stylesheet">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        <script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
         
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="../../index.html">screenlamp</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li >
                    <a href="../../index.html">Home</a>
                </li>
            
            
            
                <li >
                    <a href="../../installation/index.html">Installation</a>
                </li>
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">User Documentation <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
<li >
    <a href="../doc-overview/index.html">Overview</a>
</li>

                    
                        
<li >
    <a href="../tools/index.html">Tools</a>
</li>

                    
                        
<li >
    <a href="../tools-tutorial-1/index.html">Toolkit Tutorial</a>
</li>

                    
                        
<li class="active">
    <a href="index.html">Pipeline Tutorial</a>
</li>

                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
<li >
    <a href="../../contact/index.html">Contact</a>
</li>

                    
                        
<li >
    <a href="../../changelog/index.html">Release Notes</a>
</li>

                    
                        
<li >
    <a href="../../license/index.html">License</a>
</li>

                    
                        
<li >
    <a href="../../cite/index.html">Citing screenlamp</a>
</li>

                    
                    </ul>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                    <li >
                        <a rel="next" href="../tools-tutorial-1/index.html">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../../contact/index.html">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                
                <li>
                    <a href="https://github.com/rasbt/screenlamp">
                        
                            <i class="fa fa-github"></i>
                        
                        GitHub
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
    
        <li class="main active"><a href="#tutorial-on-using-a-pre-constructed-screenlamp-pipeline">Tutorial on Using a Pre-constructed Screenlamp Pipeline</a></li>
        
            <li><a href="#overview">Overview</a></li>
        
            <li><a href="#obtaining-and-preparing-the-dataset">Obtaining and Preparing the Dataset</a></li>
        
            <li><a href="#editing-the-configuration-file">Editing the Configuration File</a></li>
        
            <li><a href="#running-the-automated-screening-pipeline">Running the Automated Screening Pipeline</a></li>
        
            <li><a href="#canceling-and-resuming-a-screening-run">Canceling and Resuming a Screening Run</a></li>
        
    
    
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="tutorial-on-using-a-pre-constructed-screenlamp-pipeline">Tutorial on Using a Pre-constructed Screenlamp Pipeline</h1>
<h2 id="overview">Overview</h2>
<p>This tutorial explains how to use a pre-built screenlamp pipeline to perform an automated virtual screening on a small example dataset.</p>
<p>In this particular screening pipeline, we are searching for mimics of a query molecule that contain a keto-group and sulfur atom in a specified distance to each other (13-20 angstroms) and have a high overall chemical and volumetric similarity towards the query. Then, we are selecting a subset of database molecules where the keto-group of the query molecule overlays with a keto-group in the database molecules, and where the sulfur atom in the query overlays with a sulfur atom in the database molecules. The overall virtual screening pipeline is summarized in the flowchart below. For more details on the individual screening steps, please see the <a href="../tools-tutorial-1">Toolkit Tutorial</a>, which walks you through these steps using the same database and approach.</p>
<p><img alt="" src="../../images/automated-pipeline-flowchart.jpg" /></p>
<p>(A higher-resolution PDF version of this flowchart is available <a href="https://github.com/rasbt/screenlamp/blob/master/docs/sources/images/automated-pipeline-flowchart.pdf">here</a>.)</p>
<h3 id="requirements">Requirements</h3>
<p>Before you continue with the tutorial, please see the <a href="../../installation/index.html#other-software-requirements">setup instructions</a> for screenlamp if this is your first screening run.</p>
<h2 id="obtaining-and-preparing-the-dataset">Obtaining and Preparing the Dataset</h2>
<h3 id="mol2-input-files">MOL2 Input Files</h3>
<p>The automated screenlamp pipeline that is being used in this tutorial is compatible with Tripos MOL2 files of arbitrary database origin and size. A typical use case for this pipeline would be the screening of all ~18,000,000 <em>Drug-Like</em> molecules from <a href="http://zinc.docking.org">ZINC</a>, which is available in MOL2 format on ZINC <a href="http://zinc.docking.org/subsets/drug-like">here</a>. Please note that screenlamp supports both Tripos MOL2 (<code>*.mol2</code>) files and gzipped Tripos MOL2 files (<code>*.mol2.gz</code>) out of the box. Thus, if your input dataset is in gzipped format, you can use it right away without having to make any adjustments or decompressing it. However, please note that the decompressing and compressing operations that are performed when working with gzipped files have an additional toll on computational performance.</p>
<p><strong>Please keep in mind that this screening pipeline with 18,000,000 input molecules and the preconfigured settings takes about a day to complete on a multi-core desktop computer</strong>. Thus, it is recommended to work through this tutorial using a smaller dataset. With kind permission from John Irwin and the ZINC team, we recommend using a random subset of 70,000 small molecules that we prepared for this tutorial. It takes approximately 10 minutes for a multi-core Desktop computer to execute all steps in the automated, virtual screening pipeline described earlier. This subset from ZINC is split into 7 multi-MOL2 file with 10,000 molecules each: <code>partition_mol2_1.mol2</code> to <code>partition_mol2_7.mol2</code>. </p>
<p>For this tutorial, please download the dataset by clicking the following link and unzip it on your machine that you are using for the virtual screening run: <a href="https://sebastianraschka.com/datasets/screenlamp/pipeline-tutorial_1/partition_1-7.zip">https://sebastianraschka.com/datasets/screenlamp/pipeline-tutorial_1/partition_1-7.zip</a></p>
<h3 id="data-table-for-prefiltering">data table for Prefiltering</h3>
<p>For this particular tutorial, you'll also need a data table containing general information about these molecules. Although the partitions you downloaded above are only a small, modified subset of <a href="http://zinc.docking.org">ZINC</a> molecules, we are going to use the full ~18,000,000 molecule Drug-like table available for download at <a href="http://zinc.docking.org/subsets/drug-like">http://zinc.docking.org/subsets/drug-like</a>. To download the tab-separated table, click on the <a href="http://zinc.docking.org/db/bysubset/3/3_prop.xls">Properties</a> link on the <a href="http://zinc.docking.org/subsets/drug-like">ZINC Drug-like</a> page. Please note that the size of the data table is about ~1.8 Gb, and thus, the download may take a while depending on your internet connection. Alternatively, a smaller data table containing only ~170,000 molecules, please use the following link: <a href="https://sebastianraschka.com/datasets/screenlamp/pipeline-tutorial_1/small_table_p1-7.txt">https://sebastianraschka.com/datasets/screenlamp/pipeline-tutorial_1/small_table_p1-7.txt</a></p>
<h3 id="query-molecule">Query Molecule</h3>
<p>The third data file you'll need for ligand-based virtual screening is the query molecule. For this tutorial, please download the following multi-conformer MOL2 file: <a href="https://sebastianraschka.com/datasets/screenlamp/pipeline-tutorial_1/3kpzs_query.mol2">https://sebastianraschka.com/datasets/screenlamp/pipeline-tutorial_1/3kpzs_query.mol2</a></p>
<h2 id="editing-the-configuration-file">Editing the Configuration File</h2>
<p>Once you obtained the database molecules (mol2 partitions), the data table of molecular properties, and the query molecule, you can prepare the configuration file that stores the information about your local file paths and screening settings.</p>
<p>As your configuration file template, you can use the following YAML file the <a href="https://github.com/rasbt/screenlamp/blob/master/tools/pipelines/pipeline-example-1-config.yaml"><code>screenlamp/tools/pipelines/pipeline-example-1-config.yaml</code></a>, create a local copy of it and modify the file paths according to your system's configuration.</p>
<h2 id="running-the-automated-screening-pipeline">Running the Automated Screening Pipeline</h2>
<p>After you customized your configuration file, you start the screening pipeline as shown in the example command snippet below:</p>
<pre><code class="bash">python path/to/screenlamp/tools/pipelines/pipeline-example-1.py --config_file /path/to/your/config/pipeline-example-1-config.yaml --incremental true
</code></pre>

<p>By setting <code>--incremental true</code>, you will be prompted to confirm each step by pressing enter, which is recommended for the first time use.</p>
<p>For your reference, a zip archive of all files being generated via the execution of the screenlamp pipeline can be obtained via the following download link: <a href="https://sebastianraschka.com/datasets/screenlamp/pipeline-tutorial_1/pipeline-tutorial_1_outputs.zip">https://sebastianraschka.com/datasets/screenlamp/pipeline-tutorial_1/pipeline-tutorial_1_outputs.zip</a>.</p>
<h2 id="canceling-and-resuming-a-screening-run">Canceling and Resuming a Screening Run</h2>
<p>Note that throughout the screening pipeline execution, you will see a short description of the commands being executed. Also, the current pipeline step being executed will be shown in the terminal window. In case you cancel the or abort a screening run, you can resume it at the last step being executed using the <code>--start_at_step</code> flag. For example, if you quit the screening run at Step 2 by pressing CTRL+C</p>
<pre><code>################################################
Step 02: PREFILTER BY FUNCTIONAL GROUP PRESENCE
################################################

Running command:
python /Users/sebastian/code/screenlamp/tools/funcgroup_presence_to_id.py --input /Users/sebastian/Desktop/screenlamp_pipe/01_selected-mol2s --output /Users/sebastian/Desktop/screenlamp_pipe/02_3keto-and-sulfur-mol2ids.txt --selection ((atom_type == 'S.3') | (atom_type == 'S.o2')) --&gt; (atom_type == 'O.2') --processes 0

Press Enter to proceed or CTRL+C to quit
</code></pre>

<p>you can resume the run by using <code>--start_at_step 2</code> as shown in the example below:</p>
<pre><code class="bash">python path/to/screenlamp/tools/pipelines/pipeline-example-1.py --config_file /path/to/your/config/pipeline-example-1-config.yaml --incremental true --start_at_step 2
</code></pre></div>
        </div>

        <footer class="col-md-12">
            <hr>
            
                <center>Copyright &copy; 2017 Michigan State University. Developed in the <a href="http://www.kuhnlab.bmb.msu.edu">PSA Lab</a>.<br><em><a href="cite">Sebastian Raschka et al. 2017</a></em>.</center>
            
            <center>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</center>
        </footer>
        <script>var base_url = '../..';</script>
        <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>
        <script src="../../js/base.js"></script>
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
        <script src="../../mathjaxhelper.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                        <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                    </div>
                    <div class="modal-body">
                        <p>
                            From here you can search these documents. Enter
                            your search terms below.
                        </p>
                        <form role="form">
                            <div class="form-group">
                                <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                            </div>
                        </form>
                        <div id="mkdocs-search-results"></div>
                    </div>
                    <div class="modal-footer">
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>